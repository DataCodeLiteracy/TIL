# 웹/HTTP/네트워크

## 웹

웹은 하이퍼텍스트를 하이퍼링크를 통해 사용자들이 조회할 수 있도록 연결되어 있는 망을 뜻한다. 인터넷과 혼동해서 생각하는 경우가 있는데 인터넷의 경우 웹 정보뿐만아니라 메일 정보나 기타 정보들을 인터넷 망을 이용해서 주고받기 때문에 인터넷이 웹을 포괄하는 개념이다. 

웹 아키텍쳐는 크게 보면 클라이언트와 서버로 이루어져 있다. 세분화하면 서버가 WAS와 연결되어 있고 다시 DB에 정보를 저장하거나 가져오는 등의 좀 더 구체적이다. 이렇듯 웹 아키텍쳐의 설계는 다양하기 때문에 사용하는 분야에 맞춰 적절하게 하면 된다. 

그리고 이런 하이퍼텍스트인 웹에 있는 페이지들은 HTML, CSS, 자바스크립트로 이루어져있다. HTML은 마크업언어이기 때문에 구조를 담당하고 CSS는 구조화면 HTML의 스타일링을 담당하며 자바스크립트는 사용자의 동작에 따라 다른 결과물을 보여주는 동적인 처리를 담당한다. 

웹은 1.0부터 3.0까지 변화하고 있으며, 1.0은 웹에 있는 정보를 읽기만 했다면 2.0 부터는 읽기와 쓰기가 같이 되는 변화를 만들었다. 하지만 2.0까지는 데이터의 소유권이 사용자에게 있지 않기 때문에 발생하는 문제들이 있고 이를 해결하기 위해 웹 3.0이라는 개념이 등장했다. 3.0은 블록체인 기술을 이용해 보안을 강화하고 소유권이 데이터 생성자에게 있도록 하는 기술이다. 하지만 아직 보편화되어 있지 않다.

## 미리 알아두면 좋은 네트워크 개념

네트워크라고 한다면 주로 사람들 사이의 네트워크도 있지만, 이 책에서도 다루는 건 당연히 컴퓨터 네트워크다. 보통 집에서 통신하는 건 LAN이라고 하고 KT나 SKT, LGU 등이 제공하는 걸 WAN 방식이라고 한다. 

당연히 LAN이 가까운 거리를 통신하기 때문에 더 빠르다. 

그리고 OSI 7계층과 TCP/IP 4계층으로 네트워크를 해석한다. OSI의 경우 표준화가 목적이고 TCP/IP의 경우 실용성이 목적이다. 

데이터를 주고 받는 과정을 OSI 7계층으로 나타내서 설명하고는 하는데, 데이터를 보낼 때 OSI 상위 계층에서 하위 계층으로 헤더 정보를 하나씩 씌우는 걸 캡슐화라고 하며, 반대로 하위 계층에서 상위 계층으로 헤더 정보를 하나씩 제거하는 걸 역캡슐화라고 한다. 

## URI

### URL

브라우저의 주소창에 입력해서 특정 웹 자원을 고유한 형식으로 구분할 수 있게 해주는 주소

프로토콜 + 호스트 + 포트번호 + 경로 + 파라미터로 구분된다.

프로토콜은 주로 http 나 https를 많이 사용한다. 웹 상에서 자원을 주고받는 프로토콜로서 두 가지를 많이 사용하기 때문이다. 

호스트에는 실제 IP주소와 관련된 도메인이 오게 된다. 그리고 포트번호는 프로토콜의 번호와 같기 때문에 보통은 생략한다.

경로는 실제 자원이 위치한 곳을 명시한다. 예전에는 경로 모두를 나타내게 했지만, 현재는 보안적인 문제도 있고 해서 모두 표시하지는 않는다.

파라미터는 옵션을 지정해서 원하는 옵션만 보여주는 역할을 한다. 

이때 URI와 URL을 혼동할 수 있지만 URI는 URL과 URN을 합친 개념이다. 현재는 URN은 잘 사용하지 않고 URL을 주로 사용한다.

## IP

데이터를 패킷이라는 단위로 잘게 나눠서 통신할 수 있도록 하는 프로토콜, OSI 계층의 네트워크 계층에 속한다.

비신뢰성이 특징이다. 전달만할뿐 내용이 정확하게 갔는지는 신경쓰지 않는다.

보통 우리가 사용하는 체계는 IPv4 이며, 이는 32비트로 표현한다. 

IP는 네트워크 부분과 호스트 부분으로 나눠서 표현되며, 클래스로 구분지어서 네트워크, 호스트를 구분짓는 방법과 CIDR이라는 방법을 통해서 1비트 단위로 네트워크, 호스트를 구분짓는 방법이 있다.

IPv4 주소 체계는 대략 43억개를 사용할 수 있는데, 오늘날에는 이 주소 체계로는 부족한 지경에 이르렀다. 

그걸 해결하기 위한 방법으로 DHCP, NAT, IPv6가 있다. 

DHCP의 경우 동적으로 필요할 때 IP를 사용하고 사용하지 않을때는 반납하는 구조로 이루어져있다. 

NAT의 경우는 공인 IP와 사설 IP로 나눠서 개인적으로 사용할 때는 사설 IP를 사용하고 서버에 요청해야 하는 경우에는 NAT를 이용해 사설 IP를 공인 IP로 바꿔서 요청을 보내는 방식을 사용한다.

IPv6는 128비트로 이루어져있기 때문에 사실상 주소로 사용할 수 있는 숫자가 무한대(43억^4)에 가깝다고 한다. 

하지만 IPv6를 사용하기 이한 네트워크 체계를 구축하는 데 추가적인 비용이 들어가기 때문에 실제로는 많이 사용하고 있지 않는다.

## TCP

앞서 IP는 택배만 전달할 뿐, 즉 데이터만 전달할 뿐 그 데이터 안에 내용이 담겨 있는지 아닌지를 판별하지 않는다고 했다. 이런 부분을 해결하기 위해 사용하는 프로토콜이 TCP다. TCP는 신뢰성을 중요하게 생각한다. 패킷으로 나눠져있는 데이터에 TCP 헤더의 정보를 캡슐화해서 보내며, 해당 헤더 정보에 패킷의 다양한 정보가 담겨있다. 이를 통해 순서대로 받을 수 있고 조합할 수 있게 해서 신뢰성 있는 데이터를 받을 수 있다. 

TCP의 연결은 3way handshake의 과정을 거치며, 이를 통해 클라이언트와 서버가 연결을 수립한다. 클라이언트가 먼저 연결 요청을 보내고 그에 서버는 응답을 한다. 응답을 통해 서버가 연결을 할 준비가 되어 있다고 전해받은 클라이언트는 최종적으로 연결을 마무리할 요청을 보낸다.

그리고 더 이상 연결이 필요없을 때는 연결을 끊어줘야 하는데, 이때 4way handshake의 방법을 사용한다.

하지만 이런 TCP의 신뢰성있는 통신은 속도가 빠르지 않기 때문에 발생할 수 있는 문제점들이 존재한다. 통신과정에서의 문제점 중 하나는 데이터의 송신 속도가 차이가 발생할 수 있다는 점이다. 이런 흐름에 대한 제어를 해결할 수 있는 방법으로는 정지-대기 방식이 있다. 하나가 해결되면 다른 하나를 통신하는 방식이라 속도가 느리다는 단점이 있다. 이를 조금 더 해결한 방식이 슬라이딩 윈도 방식이다. 한 번에 보내는 데이터의 크기를 정해서 해당 크기의 데이터 만큼 보내고 그 데이터만큼의 크기가 들어왔다면, 다시 통신을 진행한다. 정지-대기 방식에 비해 빠르다. 

하지만 데이터 전송 속도의 차이 말고도 네트워크 자체의 문제로 인한 문제점도 있다. 이 경우에는 혼잡을 제어해야 한다. 

혼잡 제어 방식에는 합 증가/곱 감소와 느린 시작이라는 두 가지 방법이 있다.

합 증가/곱 감소 방식은 데이터를 하나씩 증가시켜가다가 네트워크의 장애나 다른 이유로 받는 쪽에서 제대로 수신을 못하고 있다면 1/2 만큼 감소시켜서 데이터를 보내고 다시 통신하고 반복하는 방식을 사용한다.

느린 시작 방식은 데이터를 1,2,4,8식으로 두 배씩 증가시켜서 보내다가 혼잡이 발생하면 다시 윈도 크기를 1로 초기화하는 방식을 말한다. 처음 시작이 느리기 때문에 느린시작 방식이라고 이름 지어졌지만, 혼잡이 자주 발생하지않으면 합 증가/곱 감소 방식보다 훨씬 빠르다.

하지만 이런 TCP의 방식도 결국에는 신뢰성을 보장으로 통신하기 때문에 속도가 느린 고질적인 문제를 해결하기는 어려웠고, 이에 맞춰 UDP라는 비신뢰성 프로토콜이 개발되었고, 신뢰성이 필요없는 경우 영상 스트리밍의 경우 UDP를 이용해서 통신하기도 한다.